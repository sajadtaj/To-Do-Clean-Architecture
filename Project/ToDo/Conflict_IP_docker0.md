## ๐งพ **ูุณุชูุฏ ุดูุงุณุง ู ุฑูุน ฺฉุงูููฺฉุช IP ุฏุฑ Docker**

---

### ๐ก **ุชุนุฑู ูุดฺฉู**

ุฏุฑ ฺฉ ุงุฒ ุณุฑูุฑูุง ูููฺฉุณ ุฏุฑูู ุดุจฺฉู ุดุฑฺฉุชุ ูพุณ ุงุฒ ุงุฌุฑุง ฺฉ ุณุฑูุณ ุจุง Docker Composeุ ูุดุงูุฏู ุดุฏ ฺฉู ุงู ุณุฑูุณ ุงุฒ **ุฏุฑูู ุดุจฺฉู PAM** ูุงุจู ูุดุงูุฏู ุงุณุช ุงูุง **ุงุฒ ุฏุงุฎู ุดุฑฺฉุช (LAN)** ูุงุจู ุฏุณุชุฑุณ ูุณุช. ุฏุฑ ุญุงู ฺฉู:

* ูพูุฑุช ุณุฑูุณ ุจูโุฏุฑุณุช ุจุง `-p 4834:80` ููุชุดุฑ ุดุฏู ุจูุฏ.
* ูุงุฑูุงู `ufw` ุจูโุฏุฑุณุช ูพูุฑุช 4834 ุฑุง ุจุงุฒ ฺฉุฑุฏู ุจูุฏ.
* ุณุฑูุณ ุจุง ููููุช ุงุฌุฑุง ุดุฏู ู ฺฉุงูุชูุฑ ูุนุงู ุจูุฏ.

---

### ๐ **ูุฑุญูู ฑ: ุจุฑุฑุณ ุฑุงุจุทโูุง ุดุจฺฉู (Network Interfaces)**

ุฏุณุชูุฑ ุฒุฑ ุงุฌุฑุง ุดุฏ:

```bash
ip a
```

ุฎุฑูุฌ:

```bash
3: docker0: <NO-CARRIER,...> state DOWN
    inet 172.17.0.1/16
```

ุฏุฑ ููู ุญุงูุ ูุดุฎุต ุดุฏ ฺฉู **ุดุจฺฉู ุฏุงุฎู ุดุฑฺฉุช ูุฒ ุงุฒ ููู ุฑูุฌ `172.17.0.0/16` ุงุณุชูุงุฏู ูโฺฉูุฏ**. ุจูุงุจุฑุงู ุฑูุฌ IP ูพู Docker (`docker0`) ุจุง ุดุจฺฉู ุดุฑฺฉุช **ฺฉุงูููฺฉุช (Conflict)** ุฏุงุดุช.

---

### ๐ฅ **ุงุซุฑุงุช ูุดฺฉู:**

* ุดุจฺฉู ุดุฑฺฉุช ููโุชูุงูุฏ ูพฺฉุชโูุง ุฑุง ุจู ุฏุฑุณุช route ฺฉูุฏ ฺูู IP ููุตุฏ ุชุฏุงุฎู ุงุณุช.
* Docker ุจู ุนูุช ฺฉุงูููฺฉุช routing ูุชูุงูุณุชู ูพู ุฑุง ูุนุงู ฺฉูุฏ (`state DOWN`).
* ฺฉุงูุชูุฑ ุฏุฑ ุญุงู ุงุฌุฑุงุณุช ูู ุงุฒ ุจุฑูู ุดุจฺฉู ุฏุฑ ุฏุณุชุฑุณ ูุณุช.

---

### ๐ง **ูุฑุญูู ฒ: ุชุญูู ุฑุงูโุญูโูุง ููฺฉู**

| ุฑุงูโุญู                                       | ูุฒุงุง                     | ูุนุงุจ                           |
| -------------------------------------------- | ------------------------- | ------------------------------- |
| ุชุบุฑ IP Bridge ุฏุงฺฉุฑ (`bip`)                 | ุณุงุฏูุ ููุซุฑุ ุณุฑุน          | ูุงุฒ ุจู restart Docker          |
| ุงุณุชูุงุฏู ุงุฒ `host` network                    | ุณุงุฏู ู ุจุฏูู NAT           | ุจุงุนุซ ุงุฒ ุฏุณุช ุฑูุชู ุงุฒููุดู       |
| ุชุนุฑู ุดุจฺฉู ุณูุงุฑุด ุจุง `docker network create` | ูุงุจู ฺฉูุชุฑู ุจุฑุง ฺูุฏ ูพุฑูฺู | ูพฺุฏฺฏ ุฏุฑ ุชูุธูุงุช ุงููู        |
| ุงุนูุงู NAT ุง static route ุฏุฑ ุฑูุชุฑ ุดุฑฺฉุช       | ุจุฏูู ุชุบุฑ ุจู ุฏุงฺฉุฑ        | ูุงุจุณุชู ุจู ุชู ุดุจฺฉู ู ุงููุช ุดุฑฺฉุช |

---

### โ **ุฑุงูโุญู ุงูุชุฎุงุจโุดุฏู: ุชุบุฑ `docker0` ุจู `192.168.147.0/24`**

---

### ๐๏ธ **ูุฑุญูู ณ: ุงุฌุฑุง ุชุบุฑ IP Bridge ุฏุฑ Docker**

#### 1. ุณุงุฎุช ุง ูุฑุงุด ูุงู `/etc/docker/daemon.json`:

```bash
sudo nano /etc/docker/daemon.json
```

ูุญุชูุง ูุงู:

```json
{
  "bip": "192.168.147.1/24"
}
```

> ููุฏุงุฑ `bip` = Bridge IP ฺฉู ุจุงุนุซ ูโุดูุฏ Docker ุดุจฺฉูโุง ุจุง subnet ุฌุฏุฏ ุจุณุงุฒุฏ.

---

#### 2. ุญุฐู ุฏุณุช ูพู ูุนู `docker0` (ุฏุฑ ุตูุฑุช ูุฌูุฏ):

```bash
sudo ip link set docker0 down
sudo ip link delete docker0
```

---

#### 3. ุฑุณุชุงุฑุช Docker:

```bash
sudo systemctl restart docker
```

---

#### 4. ุจุฑุฑุณ ุตุญุช ุชุบุฑ:

```bash
ip a | grep docker0 -A 3
```

ุจุงุฏ ุฎุฑูุฌ ูุงููุฏ ุฒุฑ ุจุงุดุฏ:

```
3: docker0: ...
    inet 192.168.147.1/24 scope global docker0
```

---

### ๐งช **ุชุณุช ููุง ุฏุณุชุฑุณ:**

ุงุฒ ุฏุงุฎู ุดุฑฺฉุช:

```bash
curl http://<IP-SERVER>:4834
```

---

### ๐ **ูฺฉุงุช DevOps ู ุงููุช**

* ุชูุตู ูโุดูุฏ ุงู ุชุบุฑ ุฏุฑ ุณุณุชูโูุง ฺูุฏุณุฑูุฑ ุงุฒ ุทุฑู **Ansible role** ูุฏุฑุช ุดูุฏ.
* ูุฑ ูพุฑูฺูโุง ฺฉู ุงุฒ `docker-compose` ุงุณุชูุงุฏู ูโฺฉูุฏุ ุจูโุตูุฑุช ูพุดโูุฑุถ ุงุฒ ููู `bridge` ุงุณุชูุงุฏู ุฎูุงูุฏ ฺฉุฑุฏ ูฺฏุฑ ุดุจฺฉู ุณูุงุฑุด ุชุนุฑู ุดูุฏ.
* ุฏูุช ุดูุฏ ฺฉู `192.168.147.0/24` ูุจุงุฏ ุฏุฑ ุดุจฺฉู ูุงูุน ุฏฺฏุฑ ูู ุงุณุชูุงุฏู ุดุฏู ุจุงุดุฏ.

---

### โ ุฌูุนโุจูุฏ ููุง

| ฺฏุงู                              | ุชูุถุญ                                                    |
| -------------------------------- | -------------------------------------------------------- |
| ูุดุงูุฏู ุนุฏู ุฏุณุชุฑุณ ุจู ุณุฑูุณ       | ููุท ุงุฒ PAM ูุงุจู ุฏุณุชุฑุณ ุจูุฏ                               |
| ุจุฑุฑุณ ูพูุฑุช ู ูุงุฑูุงู             | ููู ุตุญุญ ุจูุฏูุฏ                                           |
| ุจุฑุฑุณ `ip a` ู ุชุดุฎุต IP Conflict | docker0 ุฏุฑ `172.17.0.1/16` ุจูุฏ ฺฉู ุจุง LAN ุดุฑฺฉุช ุชุฏุงุฎู ุฏุงุดุช |
| ุชุบุฑ ุจู `192.168.147.0/24`      | ุงุฒ ุทุฑู `daemon.json`                                    |
| ุชุณุช ููุง ููููุชโุขูุฒ            | ุฏุณุชุฑุณ ุงุฒ LAN ุดุฑฺฉุช ุจุฑูุฑุงุฑ ุดุฏ                             |

---

